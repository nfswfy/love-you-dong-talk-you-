var app = {};
app.loading = function() {
    function a(a, e) {
        if (!a) return ! 1;
        for (var t = [], p = a.length, n = 0, i = 0; p > i; i++) t[i] = new Image,
        t[i].src = a[i],
        t[i].onload = function() {
            n++;
            var a = Math.floor(n / p * 100);
            $(".page0_per").html(a + "%"),
            n >= p && (e ? e() : null)
        }
    }
    var e = ["img/icon.png?v=1.0.0", "img/page1_bg.jpg", "img/bird1.png", "img/bird2.png", "img/page1_txt.png", "img/page1_txtbg.png", "img/page2_blur.png", "img/page2_bottle.png", "img/page2_clear.png", "img/page2_drip1.png", "img/page2_shadow.png", "img/page2_table.png", "img/page2_water.png", "img/page2_water2.png", "img/page3_blur.png", "img/page3_clear.png", "img/page3_shadow.png", "img/page3_sweater.png", "img/page4.png?v=1.0.1", "img/page4_bg.jpg", "img/page4_blur.png", "img/page4_paper1.png", "img/share_tips.png", "img/page5_txt.png", "img/txt.png?v=1.0.0"];
    a(e, app.init)
},
app.init = function() {
    $(".page0").fadeOut(800),
    $(".page1").addClass("on").fadeIn(800),
    app.music(),
    app.page1(),
    app.share(),
    app.rotate()
},
app.music = function() {
    var a = document.getElementById("bgm");
    a.play(),
    $(".music").show().click(function() {
        a.paused ? (a.play(), $(this).removeClass("music_off").addClass("music_on")) : (a.pause(), $(this).removeClass("music_on").addClass("music_off"))
    })
},
app.page1 = function() {
    var a = new Hammer($(".page1_touch")[0]);
    a.get("pan").set({
        direction: Hammer.DIRECTION_ALL
    }),
    a.on("panstart",
    function(a) {
        a.deltaY > 0 && ($(".page1_tips").fadeOut(), $(".page1_bird1").hide("fast"), $(".page1_bird2").css({
            opacity: 1
        }).addClass("bird2_ani"), setTimeout(function() {
            $(".page1").removeClass("on").fadeOut(800),
            $(".page2").addClass("on").fadeIn(800,
            function() {
                app.page2()
            })
        },
        3600))
    })
},
app.page2 = function() {
    var a = [function() {
        $(".page2_txt1_1").animate({
            opacity: 1
        },
        1e3, e)
    },
    function() {
        $(".page2_txt1_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page2_txt1_2").delay(1500).animate({
            opacity: 1
        },
        1e3, e)
    },
    function() {
        $(".page2_txt1_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page2_txt1_2").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page2_txt1_3").delay(1500).animate({
            opacity: 1
        },
        1e3, e)
    },
    function() {
        $(".page2_blur,.page2_shadow,.page2_table,.page2_water2,.page2_bottle,.page2_drip1").fadeIn(800),
        $(".page2_lead").delay(800).fadeIn(1e3),
        $(".page2_txt1_1,.page2_txt1_2,.page2_txt1_3").animate({
            opacity: 0
        },
        500),
        $(".page2_txt1_4").animate({
            opacity: 1,
            top: "-=.4rem"
        },
        1200);
        var a = new Hammer($(".page2")[0]),
        e = 0,
        t = 0,
        p = !1;
        a.on("panright",
        function(a) {
            return $(".page2_blur").fadeOut(600),
            $(".page2_clear").fadeIn(600),
            $(".page2_lead").fadeOut(600),
            a.deltaX > 40 ? p = !0 : "",
            a.deltaX > 40 && t >= 2 && 1 > e ? (e++, a.preventDefault(), $(".page2_txt1").fadeOut(500), app.page2txt2(), !1) : void 0
        }),
        a.on("panend",
        function(a) {
            p && (t++, p = !1),
            $(".page2_clear").fadeOut(600),
            $(".page2_blur").fadeIn(600),
            1 > e && $(".page2_lead").fadeIn(600)
        })
    }];
    $(".page2_txt").queue("slideList", a);
    var e = function() {
        $(".page2_txt").dequeue("slideList")
    };
    e()
},
app.page2txt2 = function() {
    var a = [function() {
        $(".page2_txt2_1").animate({
            opacity: 1,
            top: "-=.4rem"
        },
        1e3, e)
    },
    function() {
        $(".page2_txt2_1").delay(800).animate({
            opacity: 0
        },
        600),
        $(".page2_txt3_1").delay(1500).animate({
            opacity: 1
        },
        1e3, e)
    },
    function() {
        $(".page2_txt3_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page2_txt3_2").delay(1500).animate({
            opacity: 1
        },
        1e3, e)
    },
    function() {
        $(".page2_txt3_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page2_txt3_2").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page2_txt3_3").delay(1500).animate({
            opacity: 1
        },
        1e3),
        $(".page2_next").delay(3e3).fadeIn(1e3).one("touchstart",
        function() {
            $(".page2").removeClass("on").fadeOut(800),
            $(".page3").addClass("on").fadeIn(800,
            function() {
                app.page3()
            })
        })
    }];
    $(".page2_txt").queue("slideList", a);
    var e = function() {
        $(".page2_txt").dequeue("slideList")
    };
    e()
},
app.page3 = function() {
    $(".page3_ball").click(function() {
        return $(this).hasClass("ball_left") ? void 0 : ($(".page3_ball").addClass("ball_left"), $(".page3_ball_shadow").addClass("ball_shadow_left"), setTimeout(function() {
            $(".page3_ball").removeClass("ball_left"),
            $(".page3_ball_shadow").removeClass("ball_shadow_left")
        },
        3e3), !1)
    });
    var a = [function() {
        $(".page3_txt1_1").animate({
            opacity: 1
        },
        1e3, e)
    },
    function() {
        $(".page3_txt1_1").animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page3_txt1_2").delay(700).animate({
            opacity: 1
        },
        1e3, e)
    },
    function() {
        $(".page3_txt1_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page3_txt1_2").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page3_txt1_3").delay(1500).animate({
            opacity: 1
        },
        1e3, e)
    },
    function() {
        $(".page3_blur,.table_shadow,.page3_table,.page3_shadow,.page3_sweater,.page3_ball_shadow,.page3_ball").fadeIn(800),
        $(".page3_lead").delay(800).fadeIn(1e3);
        var a = new Hammer($(".page3")[0]),
        e = 0,
        t = 0,
        p = !1;
        a.on("pandown",
        function(a) {
            $(".page3_blur").fadeOut(600),
            $(".page3_clear").fadeIn(600),
            $(".page3_lead").fadeOut(600),
            a.deltaY > 40 ? p = !0 : "",
            a.deltaY > 40 && t >= 2 && 1 > e && (e++, $(".page3_txt1").fadeOut(500), app.page3txt2())
        }),
        a.on("panend",
        function(a) {
            p && (t++, p = !1),
            $(".page3_clear").fadeOut(1e3),
            $(".page3_blur").fadeIn(1e3),
            1 > e && $(".page3_lead").fadeIn(600)
        })
    }];
    $(".page3_txt").queue("slideList", a);
    var e = function() {
        $(".page3_txt").dequeue("slideList")
    };
    e()
},
app.page3txt2 = function() {
    var a = [function() {
        $(".page3_txt2_1").animate({
            opacity: 1,
            top: "-=.4rem"
        },
        1e3, e)
    },
    function() {
        $(".page3_txt2_1").delay(1e3).animate({
            opacity: 0
        },
        600),
        $(".page3_txt3_1").delay(1500).animate({
            opacity: 1
        },
        1e3, e)
    },
    function() {
        $(".page3_txt3_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page3_txt3_2").delay(1500).animate({
            opacity: 1
        },
        1e3, e)
    },
    function() {
        $(".page3_txt3_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page3_txt3_2").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page3_txt3_3").delay(1500).animate({
            opacity: 1
        },
        1e3),
        $(".page3_next").delay(3e3).fadeIn(1e3).on("touchstart",
        function() {
            $(".page3").removeClass("on").fadeOut(800),
            $(".page4").addClass("on").fadeIn(800,
            function() {
                app.page4()
            })
        })
    }];
    $(".page3_txt").queue("slideList", a);
    var e = function() {
        $(".page3_txt").dequeue("slideList")
    };
    e()
},
app.page4 = function() {
    var a = [function() {
        $(".page4_txt1_1").animate({
            opacity: 1
        },
        600, e)
    },
    function() {
        $(".page4_txt1_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page4_txt1_2").delay(1500).animate({
            opacity: 1
        },
        600, e)
    },
    function() {
        $(".page4_txt1_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page4_txt1_2").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page4_txt1_3").delay(1500).animate({
            opacity: 1
        },
        600,
        function() {
            $(".page4_blur,.page4_shadow,.page4_table,.page4_paper_shadow,.page4_paper1,.page4_flower,.page4_petal,.page4_lead").fadeIn(800);
            var a = new Hammer($(".page4_lead")[0]),
            e = 0;
            a.get("pan").set({
                direction: Hammer.DIRECTION_ALL
            }),
            a.on("panstart",
            function(a) {
                a.deltaY < 0 & 1 > e && (e++, app.page4txt2())
            })
        })
    }];
    $(".page4_txt").queue("slideList", a);
    var e = function() {
        $(".page4_txt").dequeue("slideList")
    };
    e()
},
app.page4txt2 = function() {
    $(".page4_lead").hide(),
    $(".page4_cold").animate({
        opacity: 0
    },
    3e3),
    $(".page4_warm").animate({
        opacity: 1
    },
    3e3),
    $(".page4_paper2,.page4_paper3").fadeIn(500);
    var a = [function() {
        $(".page4_txt1").animate({
            opacity: 0
        },
        600);
        var a = 0;
        $(".page4_paper3").animate({
            "text-indent": 0
        },
        {
            duration: 5e3,
            step: function() {
                a++,
                $(this).css({
                    bottom: "+=.5rem",
                    opacity: "-=0.003",
                    transform: "rotate(" + a / 6 + "deg)"
                })
            }
        }),
        $(".page4_txt2_1").delay(600).animate({
            opacity: 1
        },
        600, e)
    },
    function() {
        $(".page4_txt2_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page4_txt2_2").delay(1500).animate({
            opacity: 1
        },
        600, e)
    },
    function() {
        $(".page4_txt2_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page4_txt2_2").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page4_txt2_3").delay(1500).animate({
            opacity: 1
        },
        600, e)
    },
    function() {
        $(".page4_txt2").delay(800).animate({
            opacity: 0
        },
        600),
        $(".page4_blur").delay(2500).fadeOut(1e3),
        $(".page4_heart").delay(1500).fadeIn(4500),
        $(".page4_paper3").hide(),
        $(".page4_txt3_1").delay(1500).animate({
            opacity: 1
        },
        600, e)
    },
    function() {
        $(".page4_txt3_1").delay(800).animate({
            top: "-=.3rem"
        },
        1e3),
        $(".page4_txt3_2").delay(1500).animate({
            opacity: 1
        },
        600,
        function() {
            $(".page4_next").delay(800).fadeIn().one("touchstart", app.page4NextClick)
        })
    }];
    $(".page4_txt").queue("slideList", a);
    var e = function() {
        $(".page4_txt").dequeue("slideList")
    };
    e()
},
app.page4NextClick = function() {
    var a = $(".page4_cold").width(),
    e = $(".page4_cold").height(),
    t = a / 6.4,
    p = e - 3.15 * t - $(".page4_paper1").height();
    $(".page4").removeClass("on"),
    $(".page4_table,.page4_shadow,.page4_flower,.page4_petal").animate({
        bottom: "-1rem",
        opacity: 0
    },
    1e3),
    $(".page4_heart,.page4_txt3,.page4_next").animate({
        top: "-=1rem",
        opacity: 0
    },
    1e3),
    $(".page4_paper_shadow,.page4_paper1,.page4_paper2").animate({
        bottom: "+=" + p + "px"
    },
    2e3,
    function() {
        $(".page5_txt,.page5_btn1,.page5_btn2,.page5_btn3").fadeIn(1e3),
        $(".page5_btn1").one("click",
        function() {
            location.href = "http://m.clean-soft.cn/mobile/product/detail.action?id=126"
        }),
        $(".page5_btn2").one("click",
        function() {
            location.href = location.href + "?timestamp=" + (new Date).getTime()
        }),
        $(".page5_btn3").click(function() {
            $(".share").show()
        }),
        $(".share").click(function() {
            $(this).hide()
        })
    }),
    $(".page5_title").delay(800).fadeIn(1e3),
    $(".page5_txt_bg").delay(1200).fadeIn(1e3)
},
app.rotate = function() {
    document.addEventListener("touchmove",
    function(a) {
        a.preventDefault()
    }),
    window.addEventListener("deviceorientation",
    function(a) {
        var e = parseInt(a.gamma),
        t = parseInt(.4 * e);
        Math.abs(e) < 80 && ($(".page1").hasClass("on") ? ($(".page1_txt,.page1_bird1,.page1_bird2").css({
            webkitTransform: " translate3d(" + .8 * t + "px,0px,0) rotate3d(0,1,0," + 1 * t + "deg) "
        }), $(".page1_txtbg").css("webkitTransform", " translate3d(" + 2 * t + "px,0px,0) rotate3d(0,1,0," + 1.2 * t + "deg) ")) : $(".page2").hasClass("on") ? ($(".page2_bottle").css({
            webkitTransform: " translate3d(" + .8 * t + "px,0px,-50px) rotate3d(0,1,0," + 1 * t + "deg) "
        }), $(".page2_water2").css({
            webkitTransform: " translate3d(" + .8 * t + "px,0px,0px) rotate3d(0,1,0," + 1 * t + "deg) "
        }), $(".page2_drip1").css({
            "margin-left": .8 * t + "px"
        })) : $(".page3").hasClass("on") && ($(".page3_sweater").css({
            webkitTransform: " translate3d(0px,0px,-40px) rotate3d(0,1,0," + 1 * t + "deg)"
        }), $(".page3_shadow").css({
            webkitTransform: " translate3d(0px,0px,-80px) rotate3d(0,1,0," + 1 * t + "deg)"
        }), $(".page3_ball_shadow").css({
            webkitTransform: " translate3d(0px,0px,-1px)"
        })))
    })
},
app.share = function() {
    function a() {
        $.ajax({
            type: "post",
            url: "http://m.clean-soft.cn/oauth/getShareParam.action",
            data: {
                url: location.href,
                callback: "?"
            },
            dataType: "jsonp",
            jsonp: "callback",
            jsonpCallback: "handler",
            async: !1,
            success: function(a) {
                wx.config({
                    debug: !1,
                    appId: a.appid,
                    timestamp: a.timestamp,
                    nonceStr: a.nonceStr,
                    signature: a.signature,
                    jsApiList: ["checkJsApi", "onMenuShareTimeline", "onMenuShareAppMessage"]
                })
            }
        }),
        e()
    }
    function e() {
        var a = "我要开口说爱你",
        e = "洁柔易开口，爱要大声说！",
        t = location.href,
        n = p + "/img/share.jpg";
        wx.error(function(a) {}),
        wx.ready(function() {
            wx.onMenuShareAppMessage({
                title: a,
                desc: e,
                link: t,
                imgUrl: n,
                success: function() {}
            }),
            wx.onMenuShareTimeline({
                title: a,
                link: t,
                imgUrl: n,
                success: function() {}
            })
        })
    }
    function t() {
        var a = window.document.location.href,
        e = window.document.location.pathname,
        t = a.indexOf(e),
        p = a.substring(0, t),
        n = e.substring(0, e.substr(1).indexOf("/") + 1);
        return p + n
    }
    var p = t();
    a()
},
window.onload = function() {
    setTimeout(function() {
        app.loading()
    },
    0)
};